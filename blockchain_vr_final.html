<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Blockchain 3D - Interactive Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe-event-set-component@master/dist/aframe-event-set-component.min.js"></script>
    <script>
      // Display info text + sound feedback
      AFRAME.registerComponent('show-info', {
        schema: { text: { type: 'string' } },
        init: function () {
          const infoBox = document.querySelector('#infoText');
          const sound = document.querySelector('#ping');
          this.el.addEventListener('click', () => {
            infoBox.setAttribute('value', this.data.text);
            sound.components.sound.playSound();
          });
          this.el.addEventListener('mouseenter', () => {
            infoBox.setAttribute('value', this.data.text);
            sound.components.sound.playSound();
          });
        },
      });

      // Floating blocks
      AFRAME.registerComponent('float', {
        tick: function (time) {
          this.el.object3D.position.y = 1.2 + Math.sin(time / 800) * 0.05;
        },
      });

      // Pulsating connection lines
      AFRAME.registerComponent('pulse', {
        tick: function (time) {
          const pulse = (Math.sin(time / 500) + 1) / 2;
          const color = `rgb(${255 * pulse}, ${255 - 100 * pulse}, 255)`;
          this.el.setAttribute('material', 'color', color);
        },
      });

      // Floating title
      AFRAME.registerComponent('float-title', {
        tick: function (time) {
          this.el.object3D.position.y = 2.5 + Math.sin(time / 1000) * 0.05;
        },
      });
    </script>
  </head>

  <body>
    <a-scene background="color: #101018" vr-mode-ui="enabled: true">
      <!-- Camera -->
      <a-entity id="cameraRig" position="0 1.6 3">
        <a-camera look-controls="true" wasd-controls="false"></a-camera>
      </a-entity>

      <!-- Lighting -->
      <a-entity light="type: ambient; color: #999"></a-entity>
      <a-entity light="type: point; intensity: 1" position="2 4 4"></a-entity>

      <!-- Assets -->
      <a-assets>
        <audio id="ping-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_bcf0fa38b8.mp3?filename=click-21156.mp3"></audio>
      </a-assets>

      <!-- Sound source -->
      <a-entity id="ping" sound="src: #ping-sound; volume: 0.6"></a-entity>

      <!-- Floating title -->
      <a-text value="Blockchain Visualization"
              color="#00E5FF"
              position="-1.5 2.5 -1"
              width="5"
              float-title></a-text>

      <!-- Blocks -->
      <a-box color="#4CAF50" position="-1.5 1.2 0" depth="0.8" height="0.8" width="0.8"
             show-info="text: Block #1\nTimestamp: 2025-11-08\nHash: a9f3...\nPrev Hash: None\nContains: Genesis data"
             animation="property: rotation; to: 0 360 0; loop: true; dur: 8000"
             float></a-box>

      <a-box color="#03A9F4" position="0 1.2 0" depth="0.8" height="0.8" width="0.8"
             show-info="text: Block #2\nTimestamp: 2025-11-08\nHash: 4be2...\nPrev Hash: a9f3...\nContains: Transaction data"
             animation="property: rotation; to: 0 -360 0; loop: true; dur: 8000"
             float></a-box>

      <a-box color="#FF9800" position="1.5 1.2 0" depth="0.8" height="0.8" width="0.8"
             show-info="text: Block #3\nTimestamp: 2025-11-08\nHash: c2da...\nPrev Hash: 4be2...\nContains: Smart contract record"
             animation="property: rotation; to: 0 360 0; loop: true; dur: 8000"
             float></a-box>

      <!-- Animated connecting lines -->
      <a-cylinder position="-0.75 1.2 0" rotation="0 0 90" radius="0.03" height="1.5" pulse></a-cylinder>
      <a-cylinder position="0.75 1.2 0" rotation="0 0 90" radius="0.03" height="1.5" pulse></a-cylinder>

      <!-- Info text -->
      <a-text id="infoText"
              value="Look or tap a block to see technical details."
              color="#FFF"
              position="-1.8 0.3 -1"
              width="4"></a-text>

      <!-- Ground -->
      <a-plane rotation="-90 0 0" width="10" height="10" color="#222"></a-plane>
    </a-scene>
  </body>
</html>
