<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>How Blockchain Works - VR</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r158/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r158/examples/js/controls/DeviceOrientationControls.js"></script>
<style>
  html,body {margin:0;overflow:hidden;background:#050514;height:100%;width:100%;}
  #msg{position:fixed;top:10px;left:10px;color:cyan;font-family:sans-serif;}
</style>
</head>
<body>
<div id="msg">Move your phone or headset to look around</div>
<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050514);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,1.6,0);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);

const controls = new THREE.DeviceOrientationControls(camera);
const light = new THREE.PointLight(0x00ffff,2,50);
light.position.set(0,5,5);
scene.add(light);
scene.add(new THREE.AmbientLight(0x6666ff,0.5));

const material = new THREE.MeshStandardMaterial({color:0x00ffff,emissive:0x0088ff});
const centerCube = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), material);
scene.add(centerCube);

const stages = [
 "Someone requests a transaction.",
 "Transaction broadcast to peer-to-peer network (nodes).",
 "Network validates transaction and user status.",
 "A verified transaction may involve cryptocurrency or records.",
 "Verified transaction is combined to form a new block.",
 "The new block is added to the blockchain permanently.",
 "The transaction is completed."
];

const fontCanvas = document.createElement('canvas');
const ctx = fontCanvas.getContext('2d');
ctx.font = '32px Arial';
ctx.fillStyle = '#00ffff';
ctx.fillText('HOW BLOCKCHAIN WORKS',10,40);

const tex = new THREE.CanvasTexture(fontCanvas);
const titleMat = new THREE.MeshBasicMaterial({map:tex,transparent:true});
const titleGeo = new THREE.PlaneGeometry(6,1.5);
const titleMesh = new THREE.Mesh(titleGeo,titleMat);
titleMesh.position.set(0,3,-6);
scene.add(titleMesh);

const radius = 6;
for(let i=0;i<stages.length;i++){
  const angle = (i/stages.length)*Math.PI*2;
  const x = Math.cos(angle)*radius;
  const z = Math.sin(angle)*radius;

  const cube = new THREE.Mesh(new THREE.BoxGeometry(1.2,1.2,1.2), material.clone());
  cube.position.set(x,1.6,z);
  cube.lookAt(0,1.6,0);
  scene.add(cube);

  const textCanvas = document.createElement('canvas');
  textCanvas.width = 1024; textCanvas.height = 256;
  const tctx = textCanvas.getContext('2d');
  tctx.font = '30px Arial';
  tctx.fillStyle = 'white';
  tctx.fillText(`${i+1}. ${stages[i]}`,20,150);
  const tTex = new THREE.CanvasTexture(textCanvas);
  const tMat = new THREE.MeshBasicMaterial({map:tTex,transparent:true});
  const tGeo = new THREE.PlaneGeometry(6,1.5);
  const tMesh = new THREE.Mesh(tGeo,tMat);
  tMesh.position.set(x,0.3,z);
  tMesh.lookAt(0,1.6,0);
  scene.add(tMesh);
}

function animate(){
  requestAnimationFrame(animate);
  controls.update();
  centerCube.rotation.y += 0.01;
  renderer.render(scene,camera);
}
animate();

window.addEventListener('resize',()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
